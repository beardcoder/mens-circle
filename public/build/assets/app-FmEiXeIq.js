function e(){let e=document.getElementById(`navToggle`),t=document.getElementById(`nav`);if(!e||!t)return;let n={isOpen:!1,scrollPosition:0},r=t=>{e.setAttribute(`aria-expanded`,String(t)),e.setAttribute(`aria-label`,t?`Menü schließen`:`Menü öffnen`)},i=()=>{n.scrollPosition=window.scrollY,n.isOpen=!0,t.classList.add(`open`),e.classList.add(`active`),document.body.classList.add(`nav-open`),document.body.style.top=`-${n.scrollPosition}px`,r(!0)},a=(i={})=>{n.isOpen&&(n.isOpen=!1,t.classList.remove(`open`),e.classList.remove(`active`),document.body.classList.remove(`nav-open`),document.body.style.top=``,(i.restoreScroll??!0)&&window.scrollTo({top:n.scrollPosition,left:0,behavior:`instant`}),r(!1))};e.addEventListener(`click`,()=>{n.isOpen?a():i()}),t.querySelectorAll(`.nav__link, .nav__cta`).forEach(e=>{e.addEventListener(`click`,()=>{n.isOpen&&a({restoreScroll:!1})})}),document.addEventListener(`click`,r=>{n.isOpen&&!t.contains(r.target)&&!e.contains(r.target)&&a()}),document.addEventListener(`keydown`,e=>{e.key===`Escape`&&n.isOpen&&a()})}function t(){let e=document.getElementById(`header`);if(!e)return;let t=!!document.querySelector(`.hero`);document.body.classList.toggle(`has-hero`,t),document.body.classList.toggle(`no-hero`,!t);let n=()=>{let n=window.scrollY>50||!t;e.classList.toggle(`scrolled`,n)};if(n(),window.addEventListener(`scroll`,n,{passive:!0}),t){let t=document.querySelector(`.hero`);if(!t)return;new IntersectionObserver(t=>{t.forEach(t=>{e.classList.toggle(`header--on-hero`,t.isIntersecting&&t.intersectionRatio>.15)})},{threshold:[0,.15,.35,.5],rootMargin:`-10% 0px 0px 0px`}).observe(t)}}function n(){let e=document.getElementById(`scrollToTop`);if(!e)return;let t=()=>{e.classList.toggle(`visible`,window.scrollY>400)};t(),window.addEventListener(`scroll`,t,{passive:!0}),e.addEventListener(`click`,()=>{window.scrollTo({top:0,behavior:`smooth`})})}function r(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function i(e,t){let n=e.querySelector(`[type="submit"]`),r=n?.textContent??``;e.addEventListener(`submit`,async i=>{i.preventDefault(),n&&(n.disabled=!0,n.textContent=`Wird gesendet...`);let o=new FormData(e);try{let n=await(await t.onSubmit(o)).json();n.success?(e.reset(),t.onSuccess?.(n),a(`success`,n.message)):(t.onError?.(Error(n.message)),a(`error`,n.message))}catch(e){t.onError?.(e),a(`error`,`Ein Fehler ist aufgetreten. Bitte versuche es erneut.`)}finally{n&&(n.disabled=!1,n.textContent=r)}})}function a(e,t,n){let r=`toast--visible`,i={success:`✓`,error:`✕`,info:`i`,warning:`!`},a={success:`Erfolg`,error:`Fehler`,info:`Information`,warning:`Warnung`},o=document.createElement(`div`);o.className=`toast toast--${e}`,o.setAttribute(`role`,`alert`),o.setAttribute(`aria-live`,`polite`);let s=document.createElement(`div`);s.className=`toast__icon`,s.textContent=i[e],s.setAttribute(`aria-hidden`,`true`);let c=document.createElement(`div`);c.className=`toast__content`;let l=document.createElement(`div`);l.className=`toast__title`,l.textContent=n??a[e];let u=document.createElement(`div`);u.className=`toast__message`,u.textContent=t,c.appendChild(l),c.appendChild(u),o.appendChild(s),o.appendChild(c),document.body.appendChild(o),requestAnimationFrame(()=>{o.classList.add(r)});let d=()=>{o.isConnected&&o.remove()};window.setTimeout(()=>{o.classList.remove(r),o.classList.add(`toast--hiding`),o.addEventListener(`transitionend`,d,{once:!0}),window.setTimeout(d,400)},5e3)}function o(e,t){if(window.umami!==void 0)try{window.umami.track(e,t)}catch{}}const s={NEWSLETTER_SUBMIT:`newsletter-submit`,NEWSLETTER_SUCCESS:`newsletter-success`,NEWSLETTER_ERROR:`newsletter-error`,NEWSLETTER_ABANDON_FILLED:`newsletter-abandon-filled`,EVENT_REGISTRATION_SUBMIT:`event-registration-submit`,EVENT_REGISTRATION_SUCCESS:`event-registration-success`,EVENT_REGISTRATION_ERROR:`event-registration-error`,EVENT_REGISTRATION_ABANDON_FILLED:`event-registration-abandon-filled`,TESTIMONIAL_SUBMIT:`testimonial-submit`,TESTIMONIAL_SUCCESS:`testimonial-success`,TESTIMONIAL_ERROR:`testimonial-error`,TESTIMONIAL_ABANDON_FILLED:`testimonial-abandon-filled`,CALENDAR_OPEN:`calendar-open`,CALENDAR_DOWNLOAD_ICS:`calendar-download-ics`,CALENDAR_DOWNLOAD_GOOGLE:`calendar-download-google`,CTA_CLICK:`cta-click`,SOCIAL_CLICK:`social-click`,WHATSAPP_CLICK:`whatsapp-click`,EXTERNAL_LINK:`external-link`,CLICK:`click`,FAQ_EXPAND:`faq-expand`,SCROLL_DEPTH:`scroll-depth`,TIME_ON_PAGE:`time-on-page`,USER_IDLE:`user-idle`,USER_ACTIVE:`user-active`,PAGE_EXIT:`page-exit`,SECTION_VISIBLE:`section-visible`,NAV_CLICK:`nav-click`,FOOTER_LINK:`footer-link`,CONTACT_CLICK:`contact-click`};function c(e){return Array.from(e.querySelectorAll(`input, textarea, select`)).filter(e=>!(!e.name||e.disabled||e instanceof HTMLInputElement&&e.type===`hidden`))}function l(e){return e instanceof HTMLInputElement?e.type===`checkbox`||e.type===`radio`?e.checked:e.value.trim().length>0:(e instanceof HTMLSelectElement,e.value.trim().length>0)}function u(e){return e.required?e instanceof HTMLInputElement?e.type===`checkbox`||e.type===`radio`?e.checked&&e.validity.valid:e.value.trim().length>0&&e.validity.valid:(e instanceof HTMLSelectElement,e.value.trim().length>0&&e.validity.valid):!0}function d(e){let t=c(e),n=t.filter(e=>e.required),r=t.filter(e=>l(e)).length;return{requiredFilled:n.filter(e=>u(e)).length,requiredTotal:n.length,filledFields:r,totalFields:t.length}}function f(e,t,n){let r=!1,i=!1,a=null,s=()=>{a===null&&(a=Date.now())},c=()=>{r=!0},l=()=>{if(i||r||a===null)return;let s=d(e);if(s.requiredTotal===0||s.requiredFilled<s.requiredTotal)return;i=!0;let c=Math.round(s.requiredFilled/s.requiredTotal*100),l=Math.round((Date.now()-a)/1e3);o(t,{form:n,required_filled:s.requiredFilled,required_total:s.requiredTotal,required_completion_pct:c,filled_fields:s.filledFields,total_fields:s.totalFields,seconds_since_first_input:l,page:window.location.pathname})};e.addEventListener(`input`,s),e.addEventListener(`change`,s),e.addEventListener(`submit`,c,{capture:!0}),window.addEventListener(`pagehide`,l,{capture:!0}),window.addEventListener(`beforeunload`,l,{capture:!0})}function p(){let e=document.getElementById(`newsletterForm`);e&&(f(e,s.NEWSLETTER_ABANDON_FILLED,`newsletter`),i(e,{onSubmit:async e=>{let t=e.get(`email`);if(!r(t))throw Error(`Bitte gib eine gültige E-Mail-Adresse ein.`);return o(s.NEWSLETTER_SUBMIT),fetch(window.routes.newsletter,{method:`POST`,headers:{"Content-Type":`application/json`,"X-CSRF-TOKEN":window.routes.csrfToken,Accept:`application/json`},body:JSON.stringify({email:t})})},onSuccess:()=>{o(s.NEWSLETTER_SUCCESS)},onError:e=>{o(s.NEWSLETTER_ERROR,{error:e.message})}}))}function m(){let e=document.getElementById(`registrationForm`);e&&(f(e,s.EVENT_REGISTRATION_ABANDON_FILLED,`event-registration`),i(e,{onSubmit:async t=>{let n=t.get(`first_name`)?.trim(),i=t.get(`last_name`)?.trim(),a=t.get(`email`)?.trim(),c=t.get(`phone_number`)?.trim()||null,l=e.querySelector(`input[name="privacy"]`)?.checked,u=t.get(`event_id`);if(!n||!i)throw Error(`Bitte fülle alle Pflichtfelder aus.`);if(!r(a))throw Error(`Bitte gib eine gültige E-Mail-Adresse ein.`);if(!l)throw Error(`Bitte bestätige die Datenschutzerklärung.`);return o(s.EVENT_REGISTRATION_SUBMIT,{event_id:u,has_phone:c?`yes`:`no`}),fetch(window.routes.eventRegister,{method:`POST`,headers:{"Content-Type":`application/json`,"X-CSRF-TOKEN":window.routes.csrfToken,Accept:`application/json`},body:JSON.stringify({event_id:u,first_name:n,last_name:i,email:a,phone_number:c,privacy:l?1:0})})},onSuccess:()=>{o(s.EVENT_REGISTRATION_SUCCESS)},onError:e=>{o(s.EVENT_REGISTRATION_ERROR,{error:e.message})}}))}function h(){let e=document.getElementById(`testimonialForm`);if(!e)return;f(e,s.TESTIMONIAL_ABANDON_FILLED,`testimonial`);let t=e.querySelector(`#quote`),n=document.getElementById(`charCount`);t&&n&&t.addEventListener(`input`,()=>{n.textContent=String(t.value.length)});let a=e.dataset.submitUrl??``;i(e,{onSubmit:async t=>{let n=t.get(`quote`)?.trim(),i=t.get(`author_name`)?.trim()||null,c=t.get(`role`)?.trim()||null,l=t.get(`email`)?.trim(),u=e.querySelector(`input[name="privacy"]`)?.checked;if(!n||n.length<10)throw Error(`Bitte teile deine Erfahrung mit uns (mindestens 10 Zeichen).`);if(!r(l))throw Error(`Bitte gib eine gültige E-Mail-Adresse ein.`);if(!u)throw Error(`Bitte bestätige die Datenschutzerklärung.`);return o(s.TESTIMONIAL_SUBMIT,{has_name:i?`yes`:`no`,has_role:c?`yes`:`no`,char_count:n.length}),fetch(a,{method:`POST`,headers:{"Content-Type":`application/json`,"X-CSRF-TOKEN":window.routes.csrfToken,Accept:`application/json`},body:JSON.stringify({quote:n,author_name:i,role:c,email:l,privacy:u?1:0})})},onSuccess:()=>{n&&(n.textContent=`0`),o(s.TESTIMONIAL_SUCCESS)},onError:e=>{o(s.TESTIMONIAL_ERROR,{error:e.message})}})}function g(){let e=document.getElementById(`addToCalendar`),t=document.getElementById(`calendarModal`),n=document.getElementById(`calendarICS`),r=document.getElementById(`calendarGoogle`);if(!e)return;let i=window.eventData??{title:`Männerkreis Niederbayern/ Straubing`,description:`Treffen des Männerkreis Niederbayern/ Straubing. Ein Raum für echte Begegnung unter Männern.`,location:`Straubing (genaue Adresse nach Anmeldung)`,startDate:`2025-01-24`,startTime:`19:00`,endDate:`2025-01-24`,endTime:`21:30`};if(n){let e=v(i),t=new Blob([e],{type:`text/calendar;charset=utf-8`});n.href=URL.createObjectURL(t)}r&&(r.href=y(i)),e.addEventListener(`click`,()=>{t&&(o(s.CALENDAR_OPEN,{event:i.title}),t.classList.add(`open`))}),n?.addEventListener(`click`,()=>{o(s.CALENDAR_DOWNLOAD_ICS,{event:i.title})}),r?.addEventListener(`click`,()=>{o(s.CALENDAR_DOWNLOAD_GOOGLE,{event:i.title})}),t?.addEventListener(`click`,e=>{e.target===t&&t.classList.remove(`open`)})}function _(e,t){return new Date(`${e}T${t}:00`).toISOString().replace(/[-:]/g,``).replace(/\.\d{3}/,``)}function v(e){return`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Männerkreis Niederbayern/ Straubing//DE
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
DTSTART:${_(e.startDate,e.startTime)}
DTEND:${_(e.endDate,e.endTime)}
DTSTAMP:${_(new Date().toISOString().slice(0,10),new Date().toISOString().slice(11,16))}
UID:${Date.now()}@maennerkreis-straubing.de
SUMMARY:${e.title}
DESCRIPTION:${e.description.replace(/\n/g,`\\n`)}
LOCATION:${e.location}
STATUS:CONFIRMED
END:VEVENT
END:VCALENDAR`}function y(e){let t=(e,t)=>`${e.replace(/-/g,``)}T${t.replace(`:`,``)}00`;return`https://calendar.google.com/calendar/render?${new URLSearchParams({action:`TEMPLATE`,text:e.title,dates:`${t(e.startDate,e.startTime)}/${t(e.endDate,e.endTime)}`,details:e.description,location:e.location,ctz:`Europe/Berlin`}).toString()}`}var b=class{constructor(e={}){this.scrollDebounceTimer=null,this.heartbeatTimer=null,this.idleTimer=null,this.visibilityObserver=null,this.seenVisibleElements=new WeakSet,this.pageExitTracked=!1,this.initialized=!1,this.maxUmamiWaitAttempts=80,this.handleScroll=()=>{this.scrollDebounceTimer!==null&&window.clearTimeout(this.scrollDebounceTimer),this.scrollDebounceTimer=window.setTimeout(()=>{this.checkScrollDepth()},this.options.scrollDebounceMs)},this.handleActivity=()=>{let e=Date.now();if(this.state.isIdle){let t=Math.max(1,Math.round((e-this.state.lastActivityAt)/1e3));this.state.isIdle=!1,o(s.USER_ACTIVE,{idle_duration_seconds:t,page:window.location.pathname})}this.state.lastActivityAt=e},this.handleClick=e=>{if(!(e.target instanceof Element))return;if(this.options.autoTrackClicks){let t=e.target.closest(this.options.clickSelector);t&&o(t.dataset.umamiTrack??s.CLICK,this.collectElementData(t))}let t=e.target.closest(`a[href]`);!t||!this.isExternalLink(t.href)||t.hasAttribute(`data-umami-event`)||o(s.EXTERNAL_LINK,{...this.collectElementData(t),url:t.href,text:(t.textContent??``).trim().slice(0,80),page:window.location.pathname})},this.handlePageHide=()=>{this.trackPageExit()},this.handleBeforeUnload=()=>{this.trackPageExit()},this.options={scrollDepthThresholds:[25,50,75,90,100],scrollDebounceMs:120,heartbeatIntervalMs:3e4,idleTimeoutMs:6e4,autoTrackClicks:!1,clickSelector:`[data-umami-track]`,visibilityThreshold:.5,visibilitySelector:`section[id]`,debug:!1,...e},this.state={startTime:Date.now(),lastActivityAt:Date.now(),isIdle:!1,trackedScrollDepths:new Set,visibleElementsCount:0}}init(){this.initialized||(this.initialized=!0,this.waitForUmami(()=>{this.setupScrollTracking(),this.setupTimeTracking(),this.setupIdleTracking(),this.setupClickTracking(),this.setupVisibilityTracking(),this.setupPageExitTracking(),this.log(`Initialized`)}))}destroy(){this.scrollDebounceTimer!==null&&(window.clearTimeout(this.scrollDebounceTimer),this.scrollDebounceTimer=null),this.heartbeatTimer!==null&&(window.clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.idleTimer!==null&&(window.clearInterval(this.idleTimer),this.idleTimer=null),this.visibilityObserver&&=(this.visibilityObserver.disconnect(),null),window.removeEventListener(`scroll`,this.handleScroll,{capture:!1}),document.removeEventListener(`click`,this.handleClick,{capture:!1}),window.removeEventListener(`pagehide`,this.handlePageHide,{capture:!0}),window.removeEventListener(`beforeunload`,this.handleBeforeUnload,{capture:!0}),[`mousedown`,`mousemove`,`keydown`,`scroll`,`touchstart`,`click`].forEach(e=>{document.removeEventListener(e,this.handleActivity,{capture:!1})})}getStats(){return{timeOnPageSeconds:this.getTimeOnPageSeconds(),maxScrollDepth:Math.max(0,...Array.from(this.state.trackedScrollDepths)),scrollDepthsReached:Array.from(this.state.trackedScrollDepths).sort((e,t)=>e-t),isIdle:this.state.isIdle,visibleElementsCount:this.state.visibleElementsCount}}waitForUmami(e,t=0){if(typeof window.umami?.track==`function`){e();return}if(t>=this.maxUmamiWaitAttempts){this.log(`Umami script not detected in time, continuing and tracking when available`),e();return}window.setTimeout(()=>this.waitForUmami(e,t+1),100)}log(...e){this.options.debug}setupScrollTracking(){window.addEventListener(`scroll`,this.handleScroll,{passive:!0}),this.checkScrollDepth()}checkScrollDepth(){let e=document.documentElement.scrollHeight-window.innerHeight;if(e<=0)return;let t=Math.min(100,Math.round(window.scrollY/e*100));this.options.scrollDepthThresholds.forEach(e=>{t>=e&&!this.state.trackedScrollDepths.has(e)&&(this.state.trackedScrollDepths.add(e),o(s.SCROLL_DEPTH,{depth:e,percentage:`${e}%`,pixels:Math.round(window.scrollY),page:window.location.pathname}))})}setupTimeTracking(){this.heartbeatTimer=window.setInterval(()=>{if(this.state.isIdle)return;let e=this.getTimeOnPageSeconds();o(s.TIME_ON_PAGE,{seconds:e,minutes:Math.round(e/60),page:window.location.pathname})},this.options.heartbeatIntervalMs)}setupIdleTracking(){[`mousedown`,`mousemove`,`keydown`,`scroll`,`touchstart`,`click`].forEach(e=>{document.addEventListener(e,this.handleActivity,{passive:!0})}),this.idleTimer=window.setInterval(()=>{this.state.isIdle||Date.now()-this.state.lastActivityAt<this.options.idleTimeoutMs||(this.state.isIdle=!0,o(s.USER_IDLE,{active_before_idle_seconds:Math.round(this.options.idleTimeoutMs/1e3),page:window.location.pathname}))},3e4)}setupClickTracking(){document.addEventListener(`click`,this.handleClick,{passive:!0})}setupVisibilityTracking(){if(!(`IntersectionObserver`in window))return;let e=document.querySelectorAll(this.options.visibilitySelector);e.length!==0&&(this.visibilityObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(!e.isIntersecting)return;let t=e.target;this.seenVisibleElements.has(t)||(this.seenVisibleElements.add(t),this.state.visibleElementsCount+=1,o(t.dataset.umamiVisible??s.SECTION_VISIBLE,{...this.collectElementData(t),element_id:t.id||`unknown`,visibility_ratio:Math.round(e.intersectionRatio*100),page:window.location.pathname}))})},{threshold:this.options.visibilityThreshold}),e.forEach(e=>{this.visibilityObserver?.observe(e)}))}setupPageExitTracking(){window.addEventListener(`pagehide`,this.handlePageHide,{capture:!0}),window.addEventListener(`beforeunload`,this.handleBeforeUnload,{capture:!0})}trackPageExit(){if(this.pageExitTracked)return;this.pageExitTracked=!0;let e=Array.from(this.state.trackedScrollDepths);o(s.PAGE_EXIT,{total_time_seconds:this.getTimeOnPageSeconds(),max_scroll_depth:Math.max(0,...e),scroll_depth_count:e.length,page:window.location.pathname})}collectElementData(e){let t={};Object.entries(e.dataset).forEach(([e,n])=>{if(!e.startsWith(`umamiData`)||!n)return;let r=e.slice(9);if(!r)return;let i=r.charAt(0).toLowerCase()+r.slice(1);t[i]=n}),t.element=e.tagName.toLowerCase(),e.id&&(t.element_id=e.id),e.className&&(t.element_classes=String(e.className).slice(0,120));let n=(e.textContent??``).trim();return n&&(t.text=n.slice(0,80)),e instanceof HTMLAnchorElement&&e.href&&(t.href=e.href),t}isExternalLink(e){try{return new URL(e,window.location.origin).hostname!==window.location.hostname}catch{return!1}}getTimeOnPageSeconds(){return Math.max(1,Math.round((Date.now()-this.state.startTime)/1e3))}};function x(e={}){let t=new b(e);return t.init(),window.umamiTracker=t,t}document.addEventListener(`DOMContentLoaded`,()=>{e(),t(),n(),p(),m(),h(),g(),x()});