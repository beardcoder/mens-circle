<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">
<section class="hero event-hero">
    <div class="hero__bg"></div>
    <div class="hero__circles" aria-hidden="true">
        <div class="hero__circle hero__circle--1"></div>
        <div class="hero__circle hero__circle--2"></div>
        <div class="hero__circle hero__circle--3"></div>
        <div class="hero__circle hero__circle--4"></div>
    </div>

    <div class="container">
        <div class="hero__content">
            <p class="hero__label">
                <f:if condition="{isPast}">
                    <f:then>Vergangenes Treffen</f:then>
                    <f:else>Nächstes Treffen</f:else>
                </f:if>
            </p>
            <h1 class="hero__title">
                <span class="hero__title-line">{event.title}</span>
            </h1>
            <div class="hero__bottom">
                <p class="hero__description">
                    {event.eventDate -> f:format.date(format: 'l')}, {event.eventDate -> f:format.date(format: 'd.m.Y')}
                    <f:if condition="{event.startTime}">
                        · {event.startTime -> f:format.date(format: 'H:i')} Uhr
                    </f:if>
                    · {event.location}
                </p>
                <f:if condition="{isPast}">
                    <f:then></f:then>
                    <f:else>
                        <div class="hero__cta fade-in-delay-2">
                            <a
                                href="#anmeldung"
                                class="btn btn--primary btn--large"
                                data-umami-event="cta-click"
                                data-umami-event-location="hero"
                                data-umami-event-action="scroll-to-registration"
                            >
                                Jetzt anmelden
                            </a>
                        </div>
                    </f:else>
                </f:if>
            </div>
        </div>
    </div>
</section>

<f:if condition="{isPast}">
    <f:then>
        <section class="event-register-section" id="anmeldung">
            <div class="event-register__layout">
                <div class="event-register__content fade-in">
                    <div class="event-register__circles" aria-hidden="true">
                        <div class="event-register__circle event-register__circle--1"></div>
                        <div class="event-register__circle event-register__circle--2"></div>
                    </div>
                    <p class="eyebrow eyebrow--secondary">Rückblick</p>
                    <h2 class="section-title section-title--lg section-title--light event-register__title">
                        Dieses Treffen <br><span class="text-italic">hat stattgefunden</span>
                    </h2>
                    <p class="event-register__spots">
                        <span>Am {event.eventDate -> f:format.date(format: 'd.m.Y')}</span>
                    </p>
                </div>

                <div class="event-register__form-wrap fade-in fade-in-delay-1">
                    <div class="event-register__past-info">
                        <p class="event-register__past-text">
                            Dieses Treffen liegt in der Vergangenheit. Eine Anmeldung ist nicht mehr möglich.
                        </p>
                        <p class="event-register__past-text">
                            Möchtest du beim nächsten Männerkreis dabei sein? Dann trag dich in unseren Newsletter ein, um über kommende Termine informiert zu werden.
                        </p>
                        <a
                            href="/#newsletter"
                            class="btn btn--primary btn--large"
                            data-umami-event="cta-click"
                            data-umami-event-location="past-event-info"
                            data-umami-event-action="go-to-newsletter"
                        >
                            Zum Newsletter anmelden
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </f:then>
    <f:else>
        <section class="event-register-section" id="anmeldung">
            <div class="event-register__layout">
                <div class="event-register__content fade-in">
                    <div class="event-register__circles" aria-hidden="true">
                        <div class="event-register__circle event-register__circle--1"></div>
                        <div class="event-register__circle event-register__circle--2"></div>
                    </div>
                    <p class="eyebrow eyebrow--secondary">Sei dabei</p>
                    <h2 class="section-title section-title--lg section-title--light event-register__title">
                        Sichere dir <br><span class="text-italic">deinen Platz</span>
                    </h2>
                    <p class="event-register__spots">
                        <f:if condition="{isFull}">
                            <f:then>
                                <span class="event-register__spots-full">Ausgebucht</span>
                            </f:then>
                            <f:else>
                                <span class="event-register__spots-available">{availableSpots}</span>
                                <span>von {event.maxParticipants} Plätzen frei</span>
                            </f:else>
                        </f:if>
                    </p>
                </div>

                <div class="event-register__form-wrap fade-in fade-in-delay-1">
                    <f:flashMessages />
                    <f:form action="register" method="post" class="event-register__form" id="registrationForm" additionalAttributes="{autocomplete: 'on'}">
                        <f:form.hidden name="event_id" value="{event.uid}" />

                        <div class="form-row">
                            <div class="form-group">
                                <label for="firstName">Vorname</label>
                                <f:form.textfield
                                    id="firstName"
                                    name="first_name"
                                    required="required"
                                    placeholder="Dein Vorname"
                                    additionalAttributes="{autocomplete: 'given-name'}"
                                />
                            </div>

                            <div class="form-group">
                                <label for="lastName">Nachname</label>
                                <f:form.textfield
                                    id="lastName"
                                    name="last_name"
                                    required="required"
                                    placeholder="Dein Nachname"
                                    additionalAttributes="{autocomplete: 'family-name'}"
                                />
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="email">E-Mail</label>
                            <f:form.textfield
                                type="email"
                                id="email"
                                name="email"
                                required="required"
                                placeholder="deine@email.de"
                                additionalAttributes="{autocomplete: 'email', inputmode: 'email'}"
                            />
                        </div>

                        <div class="form-group">
                            <label for="phone">Handynummer <span class="form-label-optional">(optional)</span></label>
                            <f:form.textfield
                                type="tel"
                                id="phone"
                                name="phone_number"
                                placeholder="+49 170 1234567"
                                additionalAttributes="{autocomplete: 'tel', inputmode: 'tel'}"
                            />
                            <span class="form-helper">Für Erinnerungen per SMS am Veranstaltungstag</span>
                        </div>

                        <label class="form-checkbox">
                            <f:form.checkbox name="privacy" value="1" required="required" />
                            <span>Ich habe die <a href="/datenschutz" target="_blank">Datenschutzerklärung</a> gelesen und stimme der Verarbeitung meiner Daten zu.</span>
                        </label>

                        <f:if condition="{isFull}">
                            <f:then>
                                <button type="submit" class="btn btn--primary btn--large event-register__submit" disabled>
                                    Ausgebucht
                                </button>
                            </f:then>
                            <f:else>
                                <button type="submit" class="btn btn--primary btn--large event-register__submit">
                                    Verbindlich anmelden
                                </button>
                            </f:else>
                        </f:if>

                        <div id="registrationMessage"></div>
                    </f:form>
                </div>
            </div>
        </section>
    </f:else>
</f:if>

<section class="event-info-section">
    <div class="event-info__bg-text" aria-hidden="true">TERMIN</div>
    <div class="container">
        <div class="event-info__grid stagger-children">
            <div class="event-info__card event-info__card--date">
                <div class="event-info__card-circle" aria-hidden="true"></div>
                <div class="event-info__card-content">
                    <h3>Datum</h3>
                    <p class="event-info__card-value">{event.eventDate -> f:format.date(format: 'l')}</p>
                    <p class="event-info__card-sub">{event.eventDate -> f:format.date(format: 'd. F Y')}</p>
                </div>
            </div>

            <div class="event-info__card event-info__card--time">
                <div class="event-info__card-circle" aria-hidden="true"></div>
                <div class="event-info__card-content">
                    <h3>Uhrzeit</h3>
                    <p class="event-info__card-value">
                        <f:if condition="{event.startTime}">
                            <f:then>{event.startTime -> f:format.date(format: 'H:i')} Uhr</f:then>
                            <f:else>offen</f:else>
                        </f:if>
                    </p>
                    <p class="event-info__card-sub">
                        <f:if condition="{event.endTime}">
                            <f:then>bis {event.endTime -> f:format.date(format: 'H:i')} Uhr</f:then>
                            <f:else>&nbsp;</f:else>
                        </f:if>
                    </p>
                </div>
            </div>

            <div class="event-info__card event-info__card--location">
                <div class="event-info__card-circle" aria-hidden="true"></div>
                <div class="event-info__card-content">
                    <h3>Ort</h3>
                    <p class="event-info__card-value">{event.location}</p>
                    <p class="event-info__card-sub">
                        <f:if condition="{event.locationDetails}">
                            <f:then>{event.locationDetails}</f:then>
                            <f:else>Genaue Adresse nach Anmeldung</f:else>
                        </f:if>
                    </p>
                </div>
            </div>

            <div class="event-info__card event-info__card--participants">
                <div class="event-info__card-circle" aria-hidden="true"></div>
                <div class="event-info__card-content">
                    <h3>Teilnehmer</h3>
                    <p class="event-info__card-value">Max. {event.maxParticipants}</p>
                    <p class="event-info__card-sub">
                        <f:if condition="{event.costBasis}">
                            <f:then>{event.costBasis}</f:then>
                            <f:else>Auf Spendenbasis</f:else>
                        </f:if>
                    </p>
                </div>
            </div>
        </div>

        <div class="event-info__calendar fade-in">
            <button type="button" class="btn btn--secondary" id="addToCalendar">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                    <line x1="12" y1="14" x2="12" y2="18"></line>
                    <line x1="10" y1="16" x2="14" y2="16"></line>
                </svg>
                In Kalender speichern
            </button>
        </div>
    </div>
</section>

<section class="event-about-section">
    <div class="event-about__layout">
        <div class="event-about__content fade-in">
            <p class="eyebrow">Über das Treffen</p>
            <h2 class="section-title section-title--lg event-about__title">
                Ein Raum für <br><span class="text-italic">echte Begegnung</span>
            </h2>
            <div class="event-about__text">{event.description -> f:format.html()}</div>
        </div>
        <div class="event-about__visual fade-in fade-in-delay-1">
            <div class="event-about__quote-area">
                <div class="event-about__circles" aria-hidden="true">
                    <div class="event-about__circle event-about__circle--1"></div>
                    <div class="event-about__circle event-about__circle--2"></div>
                    <div class="event-about__circle event-about__circle--3"></div>
                </div>
                <p class="event-about__quote">
                    »Gemeinsam<br>
                    <span class="text-italic">wachsen</span>,<br>
                    einander<br>
                    <span class="text-italic">stärken</span>«
                </p>
            </div>
        </div>
    </div>
</section>

<section class="event-cta-section">
    <div class="event-cta__circles" aria-hidden="true">
        <div class="event-cta__circle event-cta__circle--1"></div>
        <div class="event-cta__circle event-cta__circle--2"></div>
    </div>
    <div class="container">
        <div class="event-cta__content fade-in">
            <f:if condition="{isPast}">
                <f:then>
                    <p class="eyebrow">Interesse geweckt?</p>
                    <h2 class="section-title event-cta__title">
                        Bleib <span class="text-italic">informiert</span>
                    </h2>
                    <a
                        href="/#newsletter"
                        class="btn btn--primary btn--large"
                        data-umami-event="cta-click"
                        data-umami-event-location="event-cta-bottom"
                        data-umami-event-action="go-to-newsletter"
                    >
                        Newsletter abonnieren
                    </a>
                </f:then>
                <f:else>
                    <p class="eyebrow">Bereit?</p>
                    <h2 class="section-title event-cta__title">
                        Melde dich <span class="text-italic">jetzt</span> an
                    </h2>
                    <a
                        href="#anmeldung"
                        class="btn btn--primary btn--large"
                        data-umami-event="cta-click"
                        data-umami-event-location="event-cta-bottom"
                        data-umami-event-action="scroll-to-registration"
                    >
                        Zur Anmeldung
                    </a>
                </f:else>
            </f:if>
        </div>
    </div>
</section>

<div class="calendar-modal" id="calendarModal">
    <div class="calendar-modal__content">
        <h3>In Kalender speichern</h3>
        <p>Wähle deinen Kalender:</p>
        <div class="calendar-modal__buttons">
            <a href="#" id="calendarGoogle" class="btn btn--secondary" target="_blank" rel="noopener">
                Google Calendar
            </a>
            <a href="#" id="calendarICS" class="btn btn--secondary" download="maennerkreis-straubing.ics">
                Apple/Outlook (.ics)
            </a>
        </div>
    </div>
</div>

<script>
window.eventData = {eventData -> f:format.json() -> f:format.raw()};
</script>
</html>
